name: beszel-agent
preset: service
image:
  repository: "henrygd/beszel-agent:latest"
volumes:
  - beszel_agent_data:/var/lib/beszel-agent
  - beszel_socket:/beszel_socket
  - /var/run/docker.sock:/var/run/docker.sock:ro
network: "host" # setting network to anything other than the default (haloy) means we don't use the proxy and it will not be accessible from the outside

# Targets will inherit these variables
env:
  - name: "LISTEN"
    value: "/beszel_socket/beszel.sock"
  - name: "HUB_URL"
    value: "https://beszel.haloy.dev"
  - name: "KEY"
    from:
      env: BESZEL_KEY

targets:
  hermes:
    server: hermes.haloy.dev
    env:
      - name: "TOKEN"
        from:
          env: BESZEL_AGENT_HERMES_TOKEN
  hecate:
    server: hecate.haloy.dev
    env:
      - name: "TOKEN"
        from:
          env: BESZEL_AGENT_HECATE_TOKEN


